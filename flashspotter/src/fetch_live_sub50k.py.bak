#!/usr/bin/env python3
import csv, requests

URL = "https://api.dexscreener.com/latest/dex/search?q=uniswap&order=liquidity&sort=asc&limit=50"

def main():
    r = requests.get(URL, timeout=15)
    r.raise_for_status()
    data = r.json()
    pairs = [p for p in data.get("pairs", []) if float(p.get("liquidity", {}).get("usd", 0)) < 50000]
    with open("src/tiny_liq.csv", "w", newline="") as f:
        w = csv.writer(f)
        w.writerow(["pair"])
        for p in pairs:
            w.writerow([p["pairAddress"]])
    print(f"DEX-Screener returned {len(pairs)} sub-50k pairs")

if __name__ == "__main__":
    main()
